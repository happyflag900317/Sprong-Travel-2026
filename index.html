<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>2026 æ˜¥ç¯€éš¨èº«æ‰‹å†Š</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@500;700;900&display=swap');
        body { font-family: 'Noto Serif TC', serif; background-color: #F2EFEA; color: #4A4A4A; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.4s ease; }
        .card { background: white; border-radius: 18px; box-shadow: 0 4px 15px rgba(142, 151, 117, 0.1); margin-bottom: 16px; padding: 20px; }
        .day-nav { display: flex; gap: 8px; overflow-x: auto; padding: 10px 0; scrollbar-width: none; justify-content: center; }
        .day-btn { flex: 0 0 auto; background-color: #A7AD9B; color: white; padding: 6px 14px; border-radius: 50px; font-size: 0.85rem; font-weight: 700; cursor: pointer; }
        .section-date { font-size: 1.4rem; font-weight: 900; color: #7D8E95; margin: 25px 0 15px; border-left: 4px solid #8E9775; padding-left: 12px; }
        .time-tag { color: #A7AD9B; font-weight: 700; font-size: 1.1rem; }
        .stay-tag { background: #E9EDC9; color: #6B705C; padding: 2px 8px; border-radius: 6px; font-size: 0.8rem; margin-top: 4px; display: inline-block; }
        .btn-nav { background-color: #8E9775; color: white; border-radius: 10px; padding: 8px 16px; font-weight: 700; font-size: 0.9rem; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        /* è¨˜å¸³é å›ºå®šé ‚éƒ¨ */
        .sticky-input { position: sticky; top: 120px; z-index: 30; background: #F2EFEA; padding-bottom: 10px; }
    </style>
</head>
<body class="pb-32">

    <header class="bg-white/90 backdrop-blur-md p-4 pt-10 text-center sticky top-0 z-40 shadow-sm">
        <h1 class="text-xl font-black tracking-[0.2em] text-[#5E6F64] mb-2">äºŒ ã€‡ äºŒ å…­ Â· æ˜¥ ç¯€ éŠ</h1>
        <div class="day-nav">
            <div onclick="jumpToDay('day1')" class="day-btn">D1 å°å¹´å¤œ</div>
            <div onclick="jumpToDay('day2')" class="day-btn">D2 é™¤å¤•</div>
            <div onclick="jumpToDay('day3')" class="day-btn">D3 åˆä¸€</div>
            <div onclick="jumpToDay('day4')" class="day-btn">D4 åˆäºŒ</div>
            <div onclick="jumpToDay('day5')" class="day-btn">D5 åˆä¸‰</div>
        </div>
    </header>

    <main class="p-5 max-w-md mx-auto">
        <div id="itinerary" class="tab-content active">
            <section id="day1">
                <h2 class="section-date">02/15 å°å¹´å¤œ</h2>
                <div class="card flex justify-between items-center">
                    <div><span class="time-tag">12:30</span><h3 class="font-bold text-lg">GOGOGA æ¥µä¸Šé›æ¹¯</h3><span class="stay-tag">åœç•™ 01:30</span></div>
                    <button onclick="goNav('GOGOGAæ¥µä¸Šé›æ¹¯')" class="btn-nav">å°èˆª</button>
                </div>
                <div class="card flex justify-between items-center">
                    <div><span class="time-tag">14:15</span><h3 class="font-bold text-lg">å¥½å¸‚å¤š å°ä¸­åº—</h3><span class="stay-tag">åœç•™ 01:15</span></div>
                    <button onclick="goNav('å¥½å¸‚å¤š å°ä¸­åº—')" class="btn-nav">å°èˆª</button>
                </div>
                <div class="card flex justify-between items-center">
                    <div><span class="time-tag">18:30</span><h3 class="font-bold text-lg">æ¢æŸ´ç›´ç«æ–™ç†</h3><span class="stay-tag">åœç•™ 01:30</span></div>
                    <button onclick="goNav('æ¢æŸ´ç›´ç«æ–™ç†')" class="btn-nav">å°èˆª</button>
                </div>
            </section>
            <section id="day2">
                <h2 class="section-date">02/16 é™¤å¤•</h2>
                <div class="card flex justify-between items-center">
                    <div><span class="time-tag">10:00</span><h3 class="font-bold text-lg">åè±éµé¦¬é“</h3><span class="stay-tag">åœç•™ 02:00</span></div>
                    <button onclick="goNav('åè±éµé¦¬é“')" class="btn-nav">å°èˆª</button>
                </div>
                <div class="card flex justify-between items-center">
                    <div><span class="time-tag">12:15</span><h3 class="font-bold text-lg">éº—å¯¶ OUTLET</h3><span class="stay-tag">åœç•™ 03:30</span></div>
                    <button onclick="goNav('éº—å¯¶ OUTLET')" class="btn-nav">å°èˆª</button>
                </div>
            </section>
            <section id="day3">
                <h2 class="section-date">02/17 åˆä¸€</h2>
                <div class="card flex justify-between items-center">
                    <div><span class="time-tag">10:15</span><h3 class="font-bold text-lg">è—¤å±±æ­¥é“</h3><span class="stay-tag">åœç•™ 01:15</span></div>
                    <button onclick="goNav('è—¤å±±æ­¥é“')" class="btn-nav">å°èˆª</button>
                </div>
                <div class="card flex justify-between items-center">
                    <div><span class="time-tag">14:00</span><h3 class="font-bold text-lg">å¥½ç”°æ£®æ—</h3><span class="stay-tag">åœç•™ 01:30</span></div>
                    <button onclick="goNav('å¥½ç”°æ£®æ—')" class="btn-nav">å°èˆª</button>
                </div>
                <div class="card flex justify-between items-center">
                    <div><span class="time-tag">19:00</span><h3 class="font-bold text-lg">åšèŒ¶èœ (å¤§å¢©åº—)</h3><span class="stay-tag">åœç•™ 01:30</span></div>
                    <button onclick="goNav('hechinoåšèŒ¶èœå¤§å¢©åº—')" class="btn-nav">å°èˆª</button>
                </div>
            </section>
            <section id="day4">
                <h2 class="section-date">02/18 åˆäºŒ</h2>
                <div class="card flex justify-between items-center">
                    <div><span class="time-tag">10:00</span><h3 class="font-bold text-lg">é£›ç‰›ç‰§å ´</h3><span class="stay-tag">åœç•™ 02:00</span></div>
                    <button onclick="goNav('é£›ç‰›ç‰§å ´')" class="btn-nav">å°èˆª</button>
                </div>
                <div class="card flex justify-between items-center">
                    <div><span class="time-tag">15:00</span><h3 class="font-bold text-lg">ä¸‰ç¾©é´¨ç®±å¯¶</h3><span class="stay-tag">åœç•™ 01:00</span></div>
                    <button onclick="goNav('ä¸‰ç¾©é´¨ç®±å¯¶')" class="btn-nav">å°èˆª</button>
                </div>
            </section>
            <section id="day5">
                <h2 class="section-date">02/19 åˆä¸‰</h2>
                <div class="card flex justify-between items-center">
                    <div><span class="time-tag">10:30</span><h3 class="font-bold text-lg">å°ç†Šåšç‰©é¤¨</h3><span class="stay-tag">åœç•™ 01:00</span></div>
                    <button onclick="goNav('å°ç†Šåšç‰©é¤¨')" class="btn-nav">å°èˆª</button>
                </div>
                <div class="card flex justify-between items-center">
                    <div><span class="time-tag">12:13</span><h3 class="font-bold text-lg">ä½³æ¨‚è§€å…‰æœåœ’</h3><span class="stay-tag">åœç•™ 01:07</span></div>
                    <button onclick="goNav('ä½³æ¨‚è§€å…‰æœåœ’')" class="btn-nav">å°èˆª</button>
                </div>
            </section>
        </div>

        <div id="tools" class="tab-content">
            <div class="flex justify-between items-center mb-6">
                <h2 class="font-bold text-2xl text-[#5E6F64]">ğŸ’° å…¬æ¬¾å¸³æœ¬</h2>
                <div class="text-right">
                    <span class="text-xs text-gray-400">ç¸½è¨ˆ</span>
                    <span id="total-val" class="font-black text-2xl text-[#8E9775] block">$ 0</span>
                </div>
            </div>

            <div class="sticky-input">
                <div class="card !bg-[#EAE7E0] border-2 border-[#8E9775]">
                    <div class="flex gap-2 mb-2">
                        <select id="new-exp-date" class="bg-white p-2 rounded-lg text-sm font-bold w-24">
                            <option value="02/15">02/15</option>
                            <option value="02/16">02/16</option>
                            <option value="02/17">02/17</option>
                            <option value="02/18">02/18</option>
                            <option value="02/19">02/19</option>
                        </select>
                        <input type="text" id="new-exp-name" placeholder="é …ç›®åç¨±" class="bg-white p-2 rounded-lg flex-1 outline-none text-sm">
                        <input type="number" id="new-exp-amt" placeholder="$" class="bg-white p-2 rounded-lg w-20 outline-none text-sm font-bold">
                    </div>
                    <input type="text" id="new-exp-note" placeholder="å‚™è¨» (é¸å¡«)" class="w-full bg-white/50 p-2 rounded-lg text-xs outline-none mb-3">
                    <button onclick="addNewExpense()" class="w-full py-3 bg-[#8E9775] text-white rounded-xl font-bold text-sm">+ æ–°å¢æ”¯å‡ºé …ç›®</button>
                </div>
            </div>

            <div id="expense-list-container" class="mt-4">
                </div>
        </div>

        <div id="quick-nav" class="tab-content">
             <h2 class="font-bold text-2xl text-[#5E6F64] mb-4">ğŸ“ è‡¨æ™‚å°èˆª</h2>
             <div id="location-list"></div>
             <button onclick="addQuickLoc()" class="w-full py-4 bg-[#A7AD9B] text-white rounded-2xl font-bold">+ æ–°å¢åœ°é»</button>
        </div>
    </main>

    <nav class="fixed bottom-0 w-full bg-white/95 backdrop-blur-md border-t flex justify-around p-4 pb-8 shadow-lg z-50">
        <button onclick="showTab('itinerary')" class="nav-btn flex flex-col items-center text-[#8E9775]"><i class="fas fa-calendar-alt text-xl"></i><span class="text-[10px] mt-1">é å®šè¡Œç¨‹</span></button>
        <button onclick="showTab('quick-nav')" class="nav-btn flex flex-col items-center text-gray-400"><i class="fas fa-map-marked-alt text-xl"></i><span class="text-[10px] mt-1">è‡¨æ™‚å°èˆª</span></button>
        <button onclick="showTab('tools')" class="nav-btn flex flex-col items-center text-gray-400"><i class="fas fa-wallet text-xl"></i><span class="text-[10px] mt-1">å…¬æ¬¾è¨˜å¸³</span></button>
    </nav>

    <script>
        const config = { databaseURL: "https://springtravel-2026-default-rtdb.asia-southeast1.firebasedatabase.app" };
        firebase.initializeApp(config);
        const db = firebase.database();

        // è·³è½‰åŠŸèƒ½ï¼šåˆ‡æ›åˆ°è¡Œç¨‹é ä¸¦æ²å‹•
        function jumpToDay(dayId) {
            showTab('itinerary');
            setTimeout(() => {
                const el = document.getElementById(dayId);
                if(el) {
                    const offset = 160;
                    window.scrollTo({ top: el.offsetTop - offset, behavior: 'smooth' });
                }
            }, 100);
        }

        function showTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.replace('text-[#8E9775]', 'text-gray-400'));
            event.currentTarget.classList.replace('text-gray-400', 'text-[#8E9775]');
        }

        function goNav(name) { window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(name)}`, '_blank'); }

        // è¨˜å¸³é‚è¼¯
        const dates = ["02/15", "02/16", "02/17", "02/18", "02/19"];
        
        function addNewExpense() {
            const date = document.getElementById('new-exp-date').value;
            const name = document.getElementById('new-exp-name').value;
            const amt = document.getElementById('new-exp-amt').value;
            const note = document.getElementById('new-exp-note').value;
            if(!name || !amt) return alert("è«‹è¼¸å…¥é …ç›®èˆ‡é‡‘é¡");
            
            db.ref('expenses').push({ date, name, amt: parseInt(amt), note });
            document.getElementById('new-exp-name').value = '';
            document.getElementById('new-exp-amt').value = '';
            document.getElementById('new-exp-note').value = '';
        }

        db.ref('expenses').on('value', snap => {
            const container = document.getElementById('expense-list-container');
            container.innerHTML = '';
            const data = snap.val() || {};
            let total = 0;

            dates.forEach(d => {
                const dayItems = Object.entries(data).filter(([k, v]) => v.date === d);
                if(dayItems.length > 0) {
                    const sec = document.createElement('div');
                    sec.innerHTML = `<h3 class="font-bold text-[#7D8E95] mt-4 mb-2">${d} æ”¯å‡º</h3>`;
                    dayItems.forEach(([k, v]) => {
                        total += v.amt;
                        sec.innerHTML += `
                            <div class="bg-white p-3 rounded-xl mb-2 shadow-sm border-l-4 border-[#A7AD9B] flex justify-between items-start">
                                <div>
                                    <div class="font-bold text-sm">${v.name}</div>
                                    <div class="text-[10px] text-gray-400">${v.note || ''}</div>
                                </div>
                                <div class="flex items-center gap-3">
                                    <span class="font-bold text-[#8E9775]">$${v.amt}</span>
                                    <button onclick="deleteExp('${k}')" class="text-gray-300 text-xs">âœ•</button>
                                </div>
                            </div>`;
                    });
                    container.appendChild(sec);
                }
            });
            document.getElementById('total-val').innerText = `$ ${total.toLocaleString()}`;
        });

        function deleteExp(k) { if(confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')) db.ref('expenses').child(k).remove(); }
    </script>
</body>
</html>
